; Copyright 2017 Google Inc. All Rights Reserved.
;
; Licensed under the Apache License, Version 2.0 (the "License");
; you may not use this file except in compliance with the License.
; You may obtain a copy of the License at
;
;     http://www.apache.org/licenses/LICENSE-2.0
;
; Unless required by applicable law or agreed to in writing, software
; distributed under the License is distributed on an "AS IS" BASIS,
; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
; See the License for the specific language governing permissions and
; limitations under the License.

; This file is generated by generate_memory_interceptors.py, DO NOT MODIFY.
; Regenerate this file by running syzygy/agent/asan/generate_files.bat.

.CODE

; Allow section and label names to begin with a leading period.
OPTION DOTNAME

; Declare the tail function all the stubs direct to.
EXTERN asan_redirect_tail_clang:PROC

PUBLIC asan_redirect_load1
PUBLIC asan_redirect_store1
PUBLIC asan_redirect_load2
PUBLIC asan_redirect_store2
PUBLIC asan_redirect_load4
PUBLIC asan_redirect_store4
PUBLIC asan_redirect_load8
PUBLIC asan_redirect_store8
PUBLIC asan_redirect_load10
PUBLIC asan_redirect_store10
PUBLIC asan_redirect_load16
PUBLIC asan_redirect_store16
PUBLIC asan_redirect_load32
PUBLIC asan_redirect_store32

; Declare a single top-level function to prevent identical code folding from
; folding the redirectors into one. Each redirector simply calls through to
; the tail function. This allows the tail function to trivially compute the
; redirector's address, which is used to identify the invoked redirector.
asan_redirectors PROC

; Adds a NOP at the beginning of this function to make this work when using
; incremental linking. Every reference to the first probe will otherwise be
; replaced by a jump to a thunk.
nop

asan_redirect_load1 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_store1 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_load2 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_store2 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_load4 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_store4 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_load8 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_store8 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_load10 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_store10 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_load16 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_store16 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_load32 LABEL PROC
  call asan_redirect_tail_clang
asan_redirect_store32 LABEL PROC
  call asan_redirect_tail_clang
asan_redirectors ENDP

END
